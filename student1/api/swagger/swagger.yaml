swagger: "2.0"
info:
  version: "0.0.1"
  title: Student Instance1
# during dev, should point to your local machine
host: localhost:10010
# basePath prefixes all resource paths 
basePath: /
# 
schemes:
  # tip: remove http to make production-grade
  - http
  - https
# format of bodies a client can send (Content-Type)
consumes:
  - application/json
# format of the responses to the client (Accepts)
produces:
  - application/json
paths:
  /hello:
    # binds a127 app logic to a route
    x-swagger-router-controller: hello_world
    get:
      description: Returns 'Hello' to the caller
      # used as the method name of the controller
      operationId: hello
      parameters:
        - name: name
          in: query
          description: The name of the person to whom to say hello
          required: false
          type: string
      responses:
        "200":
          description: Success
          schema:
            # a pointer to a definition
            $ref: "#/definitions/HelloWorldResponse"
        # responses may fall through to errors
        default:
          description: Error
          schema:
            $ref: "#/definitions/ErrorResponse"
  /getStudentInfo:
    x-swagger-router-controller: student1_controller
    get:
      description: Return the student in db matching given sid
      # used as the method name of the controller
      operationId: getStudentInfo
      parameters:
        - name: sid
          in: query
          description: The sid of the student 
          required: false
          type: integer
      responses:
        "200":
          description: Success
          schema:
            # a pointer to a definition
            $ref: "#/definitions/StudentResponse"
        # responses may fall through to errors
        default:
          description: Error
          schema:
            $ref: "#/definitions/ErrorResponse"
  /createStudent:
    x-swagger-router-controller: student1_controller
    post:
      summary: Create a student
      operationId: createStudent
      tags:
        - student
      parameters:
        - name: "student"
          in: "body"
          description: Student to add
          required: true
          schema:
            $ref: '#/definitions/NewStudent'
      x-examples:
        application/json: { "sid": 1,
                            "name": "Chengcheng",
                            "gender": "female",
                            "uni": "cd2789",
                            "department": "CS" }
      responses:
        "201":
          description: Student created
          headers:
            Location:
              type: string
              format: url
              description: A link to the Character
          schema:
            $ref: "#/definitions/StudentResponse"
          examples:
            application/json: |-
              {
                "name": "CCD",
                "links": [
                  {
                    "rel": "self",
                    "allow": [
                      "GET", "PUT"
                    ],
                    "href": "/getStudentInfo?sid=2"
                  },
                  {
                    "rel": "location",
                    "allow": [
                      "GET", "PUT"
                    ],
                    "href": "/student/2"
                  }
                ]
              }
        # responses may fall through to errors
        default:
          description: Error
          schema:
            $ref: "#/definitions/ErrorResponse"      
  /swagger:
    x-swagger-pipe: swagger_raw
# complex objects have schema definitions
definitions:
  StudentResponse:
    required:
    - message
    properties:
      message:
        type: string

  NewStudent:
    required:
      - name  
    properties:
      sid:
        type: integer
      name:
        type: string
      gender:
        type: string
      uni:
        type: string
      department:
        type: string
  HelloWorldResponse:
    required:
      - message
    properties:
      message:
        type: string
  ErrorResponse:
    required:
      - message
    properties:
      message:
        type: string
